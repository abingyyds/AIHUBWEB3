version: "1.3.1"
cache: true

interface:
  modelSelect: true
  parameters: true
  sidePanel: true
  presets: true
  prompts: true
  bookmarks: true
  multiConvo: true
  agents: true
  webSearch: true
  fileSearch: true
  fileCitations: true
  runCode: true
  marketplace:
    use: true
  mcpServers:
    placeholder: "MCP Servers"
  privacyPolicy:
    externalUrl: "${PRIVACY_POLICY_URL}"
    openNewTab: true
  termsOfService:
    externalUrl: "${TOS_URL}"
    openNewTab: true
  customWelcome: "Welcome, {{user.name}}."
  peoplePicker:
    users: true
    groups: true
    roles: true

registration:
  socialLogins: ["github", "google", "discord", "openid", "facebook"]

fileConfig:
  serverFileSizeLimit: 200
  avatarSizeLimit: 5
  endpoints:
    default:
      fileLimit: 20
      fileSizeLimit: 50
      totalSizeLimit: 200
      supportedMimeTypes:
        - "image/.*"
        - "application/pdf"
        - "text/.*"
        - "application/json"
        - "application/zip"
        - "application/vnd.openxmlformats-officedocument.*"
        - "application/msword"
        - "application/vnd.ms-excel"
        - "application/vnd.ms-powerpoint"
    assistants:
      fileLimit: 20
      fileSizeLimit: 50
      totalSizeLimit: 200
      supportedMimeTypes: ["image/.*", "application/pdf", "text/.*"]
    agents:
      fileLimit: 20
      fileSizeLimit: 50
      totalSizeLimit: 200
      supportedMimeTypes: ["image/.*", "application/pdf", "text/.*"]

actions:
  allowedDomains:
    - "librechat.ai"
    - "github.com"
    - "api.github.com"
    - "google.com"
    - "serper.dev"
    - "openweathermap.org"
    - "docs.firecrawl.dev"
    - "bfl.ml"

memory:
  disabled: false
  personalize: true
  messageWindowSize: 30
  tokenLimit: 8000
  charLimit: 30000
  validKeys: ["profile", "preferences", "projects", "glossary"]

ocr:
  enabled: true

webSearch:
  searchProvider: "serper"
  serperApiKey: "${SERPER_API_KEY}"
  searxngInstanceUrl: "${SEARXNG_INSTANCE_URL}"
  searxngApiKey: "${SEARXNG_API_KEY}"

  scraperProvider: "firecrawl"
  firecrawlApiKey: "${FIRECRAWL_API_KEY}"
  firecrawlApiUrl: "${FIRECRAWL_API_URL}"
  firecrawlVersion: "${FIRECRAWL_VERSION}"

  rerankerType: "jina"
  jinaApiKey: "${JINA_API_KEY}"
  jinaApiUrl: "${JINA_API_URL}"
  cohereApiKey: "${COHERE_API_KEY}"

  scraperTimeout: 7500
  safeSearch: 1

speech:
  speechTab:
    conversationMode: true
    advancedMode: true
    speechToText:
      engineSTT: "external"
      languageSTT: "English (US)"
      autoTranscribeAudio: true
      decibelValue: -45
      autoSendText: 0
    textToSpeech:
      engineTTS: "external"
      voice: "alloy"
      languageTTS: "en"
      automaticPlayback: true
      playbackRate: 1.0
      cacheTTS: true

  stt:
    openai:
      url: "${STT_OPENAI_URL}"
      apiKey: "${STT_API_KEY}"
      model: "${STT_MODEL}"
    azureOpenAI:
      instanceName: "${AZURE_STT_INSTANCE}"
      apiKey: "${AZURE_STT_API_KEY}"
      deploymentName: "${AZURE_STT_DEPLOYMENT}"
      apiVersion: "${AZURE_STT_API_VERSION}"

  tts:
    openai:
      url: "${TTS_OPENAI_URL}"
      apiKey: "${TTS_API_KEY}"
      model: "${TTS_MODEL}"
      voice: "${TTS_VOICE}"
      voices:
        - "alloy"
        - "echo"
        - "fable"
        - "onyx"
        - "nova"
        - "shimmer"

mcpServers: {}

endpoints:
  assistants:
    disableBuilder: false
    pollIntervalMs: 2000
    timeoutMs: 180000
    capabilities: ["code_interpreter", "retrieval", "actions", "tools", "image_vision"]

  agents:
    disableBuilder: false
    recursionLimit: 50
    maxRecursionLimit: 100
    allowedProviders:
      - openAI
      - anthropic
      - google
      - azureOpenAI
      - bedrock
      - assistants
      - azureAssistants
      - LiteLLM
      - OpenRouter
      - groq
      - Mistral
      - Deepseek
      - Perplexity
      - Fireworks
      - together.ai
      - xai
      - ollama
      - vLLM
    capabilities: ["execute_code", "file_search", "actions", "tools", "artifacts", "context", "ocr", "chain", "web_search"]

  # -------------------------------------------------------
  # OpenAI (OBJECT, 必须是 object)
  # 用于 LibreChat 内置 OpenAI 图片生成流程（同一套 LiteLLM）
  # -------------------------------------------------------
  openAI:
    apiKey: "${LITELLM_VIRTUAL_KEY}"
    baseURL: "${LITELLM_BASE_URL}"
    models:
      default:
        - "gemini-3-pro-image-preview"

  # -------------------------------------------------------
  # Custom Endpoints（ARRAY）
  # -------------------------------------------------------
  custom:
    - name: "LiteLLM"
      apiKey: "${LITELLM_VIRTUAL_KEY}"
      baseURL: "${LITELLM_BASE_URL}"
      models:
        fetch: true
        # v1.3.1 必填：哪怕 fetch 也要给 default 数组
        default:
          - "gpt-4.1"
      titleConvo: true
      modelDisplayLabel: "LiteLLM"

    - name: "OpenRouter"
      apiKey: "${OPENROUTER_API_KEY}"
      baseURL: "https://openrouter.ai/api/v1"
      models:
        fetch: true
        default:
          - "anthropic/claude-3.5-sonnet"
          - "google/gemini-2.0-flash-001"
          - "openai/gpt-4o-mini"
      titleConvo: true
      titleModel: "openai/gpt-4o-mini"
      dropParams: ["stop"]
      modelDisplayLabel: "OpenRouter"

    - name: "groq"
      apiKey: "${GROQ_API_KEY}"
      baseURL: "https://api.groq.com/openai/v1"
      models:
        fetch: false
        default:
          - "llama-3.1-8b-instant"
          - "llama3-70b-8192"
          - "mixtral-8x7b-32768"
      titleConvo: true
      titleMethod: "completion"
      titleModel: "llama3-70b-8192"
      modelDisplayLabel: "groq"

    - name: "Mistral"
      apiKey: "${MISTRAL_API_KEY}"
      baseURL: "https://api.mistral.ai/v1"
      models:
        fetch: true
        default:
          - "mistral-small"
          - "mistral-medium"
          - "mistral-large-latest"
      titleConvo: true
      titleModel: "mistral-small"
      dropParams: ["stop", "user", "frequency_penalty", "presence_penalty"]
      modelDisplayLabel: "Mistral"

    - name: "Deepseek"
      apiKey: "${DEEPSEEK_API_KEY}"
      baseURL: "${DEEPSEEK_BASE_URL}"
      models:
        fetch: true
        default:
          - "${DEEPSEEK_DEFAULT_MODEL}"
      titleConvo: true
      titleMethod: "completion"
      titleModel: "${DEEPSEEK_DEFAULT_MODEL}"
      modelDisplayLabel: "Deepseek"

    - name: "Perplexity"
      apiKey: "${PERPLEXITY_API_KEY}"
      baseURL: "${PERPLEXITY_BASE_URL}"
      models:
        fetch: true
        default:
          - "${PERPLEXITY_DEFAULT_MODEL}"
      titleConvo: true
      titleModel: "${PERPLEXITY_DEFAULT_MODEL}"
      modelDisplayLabel: "Perplexity"

    - name: "Fireworks"
      apiKey: "${FIREWORKS_API_KEY}"
      baseURL: "${FIREWORKS_BASE_URL}"
      models:
        fetch: true
        default:
          - "${FIREWORKS_DEFAULT_MODEL}"
      titleConvo: true
      titleModel: "${FIREWORKS_DEFAULT_MODEL}"
      modelDisplayLabel: "Fireworks"

    - name: "together.ai"
      apiKey: "${TOGETHERAI_API_KEY}"
      baseURL: "https://api.together.xyz/v1"
      models:
        fetch: false
        default:
          - "meta-llama/Llama-3.1-70B-Instruct-Turbo"
          - "mistralai/Mixtral-8x7B-Instruct-v0.1"
      titleConvo: true
      titleModel: "meta-llama/Llama-3.1-70B-Instruct-Turbo"
      modelDisplayLabel: "together.ai"

    - name: "xai"
      apiKey: "${XAI_API_KEY}"
      baseURL: "https://api.x.ai/v1"
      models:
        fetch: false
        default:
          - "grok-beta"
      titleConvo: true
      titleMethod: "completion"
      titleModel: "grok-beta"
      modelDisplayLabel: "Grok"

    - name: "vLLM"
      apiKey: "${VLLM_API_KEY}"
      baseURL: "${VLLM_BASE_URL}"
      models:
        fetch: true
        default:
          - "${VLLM_DEFAULT_MODEL}"
      titleConvo: true
      titleModel: "${VLLM_DEFAULT_MODEL}"
      modelDisplayLabel: "vLLM"

    - name: "ollama"
      apiKey: "${OLLAMA_API_KEY}"
      baseURL: "${OLLAMA_BASE_URL}"
      models:
        fetch: true
        default:
          - "${OLLAMA_DEFAULT_MODEL}"
      titleConvo: true
      titleModel: "${OLLAMA_DEFAULT_MODEL}"
      modelDisplayLabel: "ollama"
